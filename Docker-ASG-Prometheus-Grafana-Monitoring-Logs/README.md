# 📦 EC2 Monitoring & Docker Logging with Prometheus, Loki & Grafana

This project showcases a complete observability stack for EC2 instances managed by an Auto Scaling Group (ASG). The system monitors host-level metrics and collects application logs from Docker containers, all visualized through Grafana dashboards.

---

## 🧱 Architecture

Each EC2 instance created via the ASG runs a Dockerized Flask application. The instance also hosts:

- **Node Exporter** for collecting system metrics (CPU, memory, etc.)
- **Promtail** for shipping container logs to Loki
- A shared Docker volume used to bridge logs between the Flask app and Promtail

On the monitoring side, centralized services include:

- **Prometheus**, which scrapes Node Exporter metrics from EC2s
- **Loki**, which stores log data received from Promtail
- **Grafana**, which connects to both Prometheus and Loki to display dashboards

---

## 🚀 Project Workflow

1. A shared Docker volume is created for logs
2. The Flask app container writes logs to this volume
3. Promtail reads those logs from the same volume and ships them to Loki
4. Prometheus scrapes metrics from Node Exporter running on the EC2 hosts
5. Grafana visualizes both metrics and logs through unified dashboards

---

## 🐳 Docker Commands Used

The following containers were involved in the setup:

```bash
# 1. Create a shared Docker volume
docker volume create flask_logs

# 2. Run the Flask app (mounts volume to /app/logs)
docker run -d --name flask-app \
  -v flask_logs:/app/logs \
  -p 80:80 your-flask-image

# 3. Run Promtail (mounts the SAME volume and config)
docker run -d --name promtail \
  -v flask_logs:/app/logs \
  -v /path/to/your/promtail-config.yaml:/etc/promtail/config.yaml \
  -p 9080:9080 \
  grafana/promtail:latest \
  -config.file=/etc/promtail/config.yaml
```

---

## 📊 Monitoring Capabilities

- **Host Metrics**: Each EC2 instance exposes system-level metrics using Node Exporter, which Prometheus scrapes and stores.
- **Application Logs**: All logs generated by the Flask app inside containers are shipped by Promtail to Loki.
- **Visualization**: Grafana uses PromQL (for metrics) and LogQL (for logs) to present detailed, customizable dashboards.

---

## 🏢 Organizational Benefits

📈 **Centralized Observability**  
This setup brings both metrics and logs under one roof. No SSH needed to debug.

⚙️ **Auto-Scaling Ready**  
As the ASG scales out/in, Prometheus and Loki continue collecting from new or removed instances.

💡 **Developer Productivity**  
Developers can use Grafana to detect issues in real-time, without digging through log files manually.

💸 **Cost-Effective and Open Source**  
All components (Prometheus, Loki, Grafana, Node Exporter, Promtail) are fully open-source and production-ready.

🚀 **Portable & Repeatable**  
The design follows infrastructure-as-code principles, and can be extended to Kubernetes or container orchestration setups later.

---

Made by [Zoraiz Ahmad](https://github.com/zoraiz53)
Contact ME on [LINKEDIN](https://www.linkedin.com/in/zoraiz-ahmad-89b402330/)